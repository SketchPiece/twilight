// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id String @id @default(cuid())

  nickname         String  @unique
  passwordHash     String
  publicKey        String
  avatarUrl        String?
  refreshTokenHash String?

  updated DateTime @updatedAt
  created DateTime @default(now())

  @@map("users")
}

model Inbox {
  id String @id @default(cuid())

  userId   String
  senderId String

  hash         String
  lastMessage  String
  unseenNumber Int      @default(0)
  updated      DateTime @updatedAt
  created      DateTime @default(now())
  @@map("inboxes")
}

model Message {
  id String @id @default(cuid())

  senderId               String
  senderEncryptedText    String
  recipientEncryptedText String
  inboxHash              String
  updated                DateTime @updatedAt
  created                DateTime @default(now())
  @@map("messages")
}
